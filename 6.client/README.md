### v8垃圾回收机制
- V8是基于分代得垃圾回收
- 不同代垃圾回收机制也不一样
- 按存活时间分为新生代和老生代

### rss
- 包括堆区（对象闭包）,栈区（变量、指针）,代码区域
- 堆内存中包括使用到得堆内存和未使用得
- heapUsed 用到得堆得部分。判断内存泄漏以heapUsed字段为准
- external: V8引擎内部得c++对象占用得内存
- 为何V8限制内存大小呢？因为内存越大垃圾回收需要时间越长

### 新生代垃圾回收
- 新生代区域一分为二，每个16M，一个使用，一个空闲
- 开始回收得时候会检查From区域中得存活对象，如果还活着，拷贝到To空间， 完成后释放空间
- 然后from和to进行呼唤
- 新生代扫描得时候是一种广泛得优先扫描策略（即一个扫描，一个分配指针，如果二者重叠，那么垃圾回收结束）
- 新生代得空间小，存活对象少
- 当一个对象经理过多次得垃圾回收依然存活的时候，生存周期长得对象会被移动到老生代，这个移动过程被称为晋升或者升级
    1. 经过5次以上的回收还存在
    2. To空间使用占比超过25%或者超大对象 

### 引用计数
- 语言引擎有一张引用表，保存了内存里面所有的资源得引用次数
- 如果一个值得引用次数为0，就表示这个值不再用到了，因此可以将这块内存释放掉

### 老生代
- mark-sweep(标记清除) mark-compact(标记整理)
    1. 标记清除比较快速但是缺点是形成碎片，浪费空间
    2. 标记整理时想左移动，回收边界右边区域
- 老生代空间大，大部分都是活着的对象， GC耗时比较长
- 在GC期间无法响应，STOP-THE-WORLD
- V8有一个优化方案，增量处理，把一个大暂停换成多个小暂停

